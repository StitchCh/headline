webpackJsonp([90],{EfnJ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mvHQ"),n=i.n(a),s=i("O4Lo"),l={name:"works-unpublished",props:{channel:{type:Array,default:function(){return[]}},childChannel:{type:Array,default:function(){return[]}},scrollTop:{type:Number},layout:{type:Array,default:function(){return[]}}},data:function(){return{classList:[{app:"SPECIAL",name:"专题",state:!1},{app:"VIDEO",name:"视频",state:!1},{app:"ARTICLE",name:"文章",state:!1},{app:"AUDIO",name:"音频",state:!1},{app:"LIVE",name:"直播",state:!1},{app:"ECOMMERCE",name:"电商",state:!1},{app:"LINK",name:"链接",state:!1},{app:"GALLERY",name:"图集",state:!1},{app:"VOTE",name:"投票",state:!1}],classShow:!1,treeBubbleShow:!1,loading:!1,size:30,page:1,totalPage:0,filterChannelId:this.$route.query.channelId,searchKey:"",activeLayoutId:"",data:[],appTypeList:{},checked:[],appList:[]}},mounted:function(){this.activeLayoutId=this.$route.query.typeId,this.appTypeList=this.$store.state.account.appTypeList},created:function(){this.getList()},watch:{"$route.query.typeId":function(){this.activeLayoutId=this.$route.query.typeId},"$route.query.channelId":function(t){this.filterChannelId=t},filterChannelId:function(){this.getList()},searchKey:function(){this.search()},layout:function(t){this.checked=[]}},computed:{checkedId:function(){return this.layoutChecked.map(function(t){return t.id})},filterChannelName:function(){var t=this,e="";return this.filterChannelId?(this.channel.forEach(function(i){i.id===t.filterChannelId&&(e=i.channelName)}),e):"所有频道文章"},layoutChecked:function(){var t=this;return this.checked.filter(function(e){return e.layoutId===t.activeLayoutId})}},methods:{searchClass:function(t){var e=this;t.state=!t.state,this.appList=[],this.classList.forEach(function(t){t.state&&e.appList.push(t.app)}),this.getList()},getList:function(){var t=this;this.loading=!0;var e="";this.appList.length>0&&(e=this.appList.join(",")),this.$http.post("/cri-cms-platform/issue/getChannelContentList.monitor",{pageSize:this.size,toPage:this.page,channelId:this.filterChannelId||this.$route.query.channelId,filterChannelId:!!this.filterChannelId,title:this.searchKey,app:e}).then(function(e){t.loading=!1,e.data.forEach(function(t){t.checked=!1}),t.data=e.data,console.log(e.data),t.totalPage=e.totalPage}).catch(function(e){t.loading=!1,t.$toast(e.msg)})},add:function(){console.log("a")},checkItem:function(t){this.activeLayoutId?((t=JSON.parse(n()(t))).layoutId=this.activeLayoutId,this.checked.push(t)):this.$toast("请选择布局")},unCheckItem:function(t){var e=this.checked.indexOf(t);this.checked.splice(e,1)},onTreeSelect:function(t){this.filterChannelId=t.id,this.treeBubbleShow=!1},search:i.n(s)()(function(){this.getList()},500),confirm:function(){this.$emit("add",this.checked)}}},c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"c-6 f-14 works-unpublished"},[i("div",{staticClass:"flex",staticStyle:{width:"100%",height:"100%"}},[i("div",{staticClass:"left flex-item",staticStyle:{width:"50%"}},[i("div",{staticClass:"card relative",staticStyle:{height:"100%"}},[i("div",{staticClass:"flex-v-center card-title"},[i("div",{staticClass:"flex-item"},[i("div",{staticClass:"relative",staticStyle:{display:"inline-block"}},[i("span",{staticClass:"a b blue",on:{click:function(e){t.treeBubbleShow=!t.treeBubbleShow}}},[t._v("\n                "+t._s(t.filterChannelName)+"\n                "),i("i",{staticClass:"icon"},[t._v("keyboard_arrow_down")])]),t._v(" "),t.treeBubbleShow?i("bubble",{attrs:{pos:"bottom",align:"start"},on:{close:function(e){t.treeBubbleShow=!1}}},[i("div",{staticStyle:{width:"250px",padding:"10px 0"}},[i("div",{staticClass:"tree-node c-4",on:{click:function(e){t.filterChannelId="",t.treeBubbleShow=!1}}},[i("div",{staticClass:"tree-title",class:{on:!t.filterChannelId},staticStyle:{"padding-left":"20px"}},[t._v("所有频道文章")])]),t._v(" "),i("tree",{staticClass:"c-4",attrs:{data:t.channel,activeId:t.filterChannelId,"open-all":"",pidTxt:"channelPartentId"},on:{select:t.onTreeSelect}})],1)]):t._e()],1)]),t._v(" "),i("div",{staticClass:"relative",staticStyle:{"margin-right":"20px"}},[i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"筛选分类",expression:"'筛选分类'"}],staticClass:"relative flex-v-center a item",on:{click:function(e){t.classShow=!0}}},[i("span",[t._v("分类")]),i("i",{staticClass:"icon c-a"},[t._v("keyboard_arrow_down")])]),t._v(" "),t.classShow?i("bubble",{attrs:{pos:"bottom",align:"center"},on:{close:function(e){t.classShow=!1}}},[i("ul",{staticClass:"filter-bubble"},t._l(t.classList,function(e){return i("li",{staticClass:"a flex-v-center",staticStyle:{width:"50px",padding:"5px 10px"},on:{click:function(i){t.searchClass(e)}}},[i("span",{staticClass:"flex-item"},[t._v(t._s(e.name))]),t._v(" "),e.state?i("i",{staticClass:"icon f-14 blue check-ico"},[t._v("check")]):t._e()])}))]):t._e()],1),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchKey,expression:"searchKey"}],staticClass:"f-14",staticStyle:{margin:"0",padding:"4px 6px",width:"150px",border:"1px solid #eee","border-radius":"4px"},attrs:{type:"text",placeholder:"标题关键字"},domProps:{value:t.searchKey},on:{input:function(e){e.target.composing||(t.searchKey=e.target.value)}}})]),t._v(" "),t.loading?i("div",{staticClass:"abs flex-center"},[i("loading",{attrs:{size:"30"}})],1):t._e(),t._v(" "),t.data.length||t.loading?t._e():i("div",{staticClass:"f-12 c-a t-center",staticStyle:{"margin-top":"15px"}},[t._v("暂无数据")]),t._v(" "),i("ul",{staticStyle:{height:"calc(100% - 70px)",overflow:"auto"}},t._l(t.data,function(e){return i("li",{key:e.id,staticClass:"flex-v-center li-item"},[i("span",{staticClass:"flex-item li-title"},[t._v("【"+t._s(t.appTypeList[e.app])+"】"+t._s(e.title))]),t._v(" "),i("icon-btn",{attrs:{small:"",disabled:t.checkedId.includes(e.id)},on:{click:function(i){t.checkItem(e)}}},[t._v("arrow_forward")])],1)})),t._v(" "),t.totalPage>1?i("pagination",{staticStyle:{"border-top":"1px solid #eee",padding:"5px 0"},attrs:{page:t.page,size:t.size,total:t.totalPage*t.size},on:{change:function(e){t.page=e,t.getList()}}}):t._e()],1)]),t._v(" "),i("div",{staticClass:"right",staticStyle:{width:"50%"}},[i("div",{staticClass:"card flex-item",staticStyle:{"margin-left":"5px"},style:{marginTop:t.scrollTop+"px"}},[i("div",{staticClass:"flex-v-center card-title"},[i("div",{staticClass:"b blue flex-item"},[t._v("已选择")]),t._v(" "),i("btn",{attrs:{disabled:!t.checked.length},on:{click:t.confirm}},[t._v("确定选取")])],1),t._v(" "),i("div",{staticClass:"flex"},[i("div",{staticClass:"layout-tab"},[i("ul",{staticStyle:{overflow:"hidden"}},t._l(t.layout,function(e){return i("li",{key:e.id,staticClass:"a",class:{on:t.activeLayoutId===e.id,disabled:"3"===e.type},on:{click:function(i){t.activeLayoutId=e.id}}},[t._v(t._s(e.layoutName))])}))]),t._v(" "),i("transition-group",{staticClass:"flex-item",staticStyle:{overflow:"hidden"},attrs:{name:"slide-x",tag:"ul"}},t._l(t.layoutChecked,function(e){return i("li",{key:e.id,staticClass:"flex-v-center li-item"},[i("span",{staticClass:"flex-item li-title"},[t._v("【"+t._s(t.appTypeList[e.app])+"】"+t._s(e.title))]),t._v(" "),i("icon-btn",{attrs:{small:""},on:{click:function(i){t.unCheckItem(e)}}},[t._v("close")])],1)}))],1)])])])])};c._withStripped=!0;var o={render:c,staticRenderFns:[]},r=o;var d=!1;var u=i("VU/8")(l,r,!1,function(t){d||i("Xmvb")},null,null);u.options.__file="src/apps/works/unpublished.vue";e.default=u.exports},Xmvb:function(t,e,i){var a=i("ciA2");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("40901b8a",a,!1,{})},ciA2:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.works-unpublished {\n  height: 100%;\n}\n.works-unpublished * {\n  max-height: 100%;\n}\n.works-unpublished .card {\n  border-radius: 5px;\n  -webkit-box-shadow: none;\n          box-shadow: none;\n  margin-bottom: 15px;\n  padding: 15px;\n  white-space: nowrap;\n}\n.works-unpublished .li-item {\n  line-height: 1em;\n}\n.works-unpublished .li-item:hover {\n  background: #eee;\n}\n.works-unpublished .li-title {\n  text-overflow: ellipsis;\n  overflow: hidden;\n  padding: 10px;\n}\n.works-unpublished .card-title {\n  padding: 0 10px 10px;\n  border-bottom: 1px solid #eee;\n}\n.works-unpublished .layout-tab {\n  width: 80px;\n  border-right: 1px solid #eee;\n}\n.works-unpublished .layout-tab li {\n  padding: 10px;\n  line-height: 1em;\n}\n.works-unpublished .layout-tab li.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.works-unpublished .layout-tab li:hover {\n  background: #eee;\n}\n.works-unpublished .layout-tab li.on {\n  background: #0299ff;\n  color: #fff;\n}\n",""])}});