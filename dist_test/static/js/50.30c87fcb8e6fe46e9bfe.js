webpackJsonp([50],{"7s84":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("2get"),s=i("MYRd"),n=i("qfV/"),o={AUDITING:{text:"待审",icon:"hourglass_full",color:"#ffc107"},REJECT:{text:"驳回",icon:"error",color:"#ff5252"},PASS:{text:"通过",icon:"check_circle",color:"#4caf50"}},l={name:"app-audit",components:{Account:a.a,AfLeft:s.a,ListView:n.a},props:["id"],data:function(){return{totalRowsAmount:!1,ui:{getUrl:"/cri-cms-platform/audit/get.monitor",status:o,classShow:!1,searchOptionShow:!1,searchAppShow:!1,channelShow:!1,orderShow:!1,channels:[],orderby:[{id:"create_date",name:"日期"},{id:"pv",name:"阅读"},{id:"comment_count",name:"评论"},{id:"share_count",name:"分享"},{id:"digg_count",name:"点赞"}],searchby:[{id:"title",name:"标题"},{id:"keywords",name:"关键字"},{id:"abstracts",name:"摘要"},{id:"author",name:"作者"}],appList:[{id:"",name:"全部"},{id:"ARTICLE",name:"文章"},{id:"GALLERY",name:"图集"},{id:"VIDEO",name:"视频"},{id:"AUDIO",name:"音频"},{id:"SPECIAL",name:"专题"},{id:"LINK",name:"链接"},{id:"ECOMMERCE",name:"电商"},{id:"LIVE",name:"直播"},{id:"VOTE",name:"投票"}],totalPage:1,rejectShow:!1},filter:{status:"all",pageSize:30,toPage:1,orderby:"create_date",order:"desc",searchby:"title",search:"",app:"",publishChannelId:"",recommend:""},list:[],channels:[],rejectMessage:"",classList:[{app:"SPECIAL",name:"专题",state:!1},{app:"VIDEO",name:"视频",state:!1},{app:"ARTICLE",name:"文章",state:!1},{app:"AUDIO",name:"音频",state:!1},{app:"LIVE",name:"直播",state:!1},{app:"ECOMMERCE",name:"电商",state:!1},{app:"LINK",name:"链接",state:!1},{app:"GALLERY",name:"图集",state:!1},{app:"VOTE",name:"投票",state:!1}],appList:[]}},computed:{defaultActive:function(){var t=this.$route.name;t=t||"";var e=this.$route.query.status;return e||t.replace("Content","")},searchByName:function(){var t=this,e=this.ui.searchby.find(function(e){return e.id===t.filter.searchby});return e?e.name:"--"},searchApp:function(){var t=this,e=this.ui.appList.find(function(e){return e.id===t.filter.app});return e?e.name:"--"},status:function(){var t=this;if(!this.list.length||!this.id)return!1;var e=this.list.find(function(e){return e.id===t.id});return!(!e||"AUDITING"!==e.auditStatus)}},methods:{searchClass:function(t){var e=this;t.state=!t.state,this.appList=[],this.classList.forEach(function(t){t.state&&e.appList.push(t.app)}),this.getList()},getList:function(t){var e=this,i=this.filter;t&&(i.toPage=1),this.$refs.listView.loading=!0,console.log(i),i.app=this.appList.join(","),this.$http.post("/cri-cms-platform/audit/list.monitor",i).then(function(t){e.totalRowsAmount=t.totalRowsAmount,e.list=t.pages||[];for(var i=0;i<e.list.length;i++)e.list[i].app&&"SPECIAL"===e.list[i].app?e.list[i].appname="专题":"VIDEO"===e.list[i].app?e.list[i].appname="视频":"ARTICLE"===e.list[i].app?e.list[i].appname="文章":"AUDIO"===e.list[i].app?e.list[i].appname="音频":"LIVE"===e.list[i].app?e.list[i].appname="直播":"ECOMMERCE"===e.list[i].app?e.list[i].appname="电商":"LINK"===e.list[i].app?e.list[i].appname="链接":"GALLERY"===e.list[i].app?e.list[i].appname="图集":"VOTE"===e.list[i].app&&(e.list[i].appname="投票");e.ui.totalPage=t.totalPage||1,e.$refs.listView.loading=!1,e.onItemClick(e.list[0])}).catch(function(t){e.$refs.listView.loading=!1})},getChannels:function(){var t=this;return this.$http.post("/cri-cms-platform/audit/getChannels.monitor").then(function(e){t.ui.channels=e||[]}).catch(function(e){t.$toast(e.msg)})},onPrev:function(){var t=this.filter;1!==t.toPage&&(t.toPage=t.toPage<=1?1:t.toPage-1,this.getList())},onNext:function(){var t=this.filter,e=this.ui.totalPage;t.toPage!==e&&(t.toPage=t.toPage>=e?e:t.toPage+1,this.getList())},onItemClick:function(t){this.$router.replace({path:"/audit/"+t.app+"/"+t.id,query:this.$route.query})},audit:function(t){var e=this,i={id:this.id,auditStatus:t};"REJECT"===t&&(i.rejectMessage=this.rejectMessage),this.$http.post("/cri-cms-platform/audit/audit.monitor",i).then(function(i){e.ui.rejectShow=!1,e.getList(),e.$router.replace({path:"/audit",query:e.$route.query}),e.$toast("审核"+e.ui.status[t].text)}).catch(function(t){e.$toast(t.msg)})}},created:function(){var t=this,e=this.filter,i=this.$route.query.status;i!==e.status&&(e.status=i),this.getChannels().then(function(){return t.getList()})},watch:{"$route.query":function(t){var e=this.filter;t.status!==e.status&&(e.status=t.status,this.getList(!0))},channels:function(){this.filter.publishChannelId=this.channels.join(","),this.getList(!0)},"filter.orderby":function(){this.ui.orderShow=!1,this.getList(!0)},"filter.order":function(){this.ui.orderShow=!1,this.getList(!0)},"filter.searchby":function(){this.ui.searchOptionShow=!1,this.filter.search&&this.getList(!0)},"filter.app":function(){this.ui.searchAppShow=!1,this.getList(!0)}}},r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"abs bg-f flex app-audit"},[i("af-left",{attrs:{color:"#00897B","vibrant-color":"#00897B","bg-color":"#E0F2F1",title:"审核",defaultActive:t.defaultActive}},[i("navigator-item",{attrs:{icon:"folder",index:"all-all"},on:{click:function(){"all"!=t.$route.query.status&&t.$router.replace("/audit?status=all")}}},[t._v("全部")]),t._v(" "),i("navigator-item",{attrs:{icon:"hourglass_full",index:"AUDITING"},on:{click:function(){"AUDITING"!=t.$route.query.status&&t.$router.replace("/audit?status=AUDITING")}}},[t._v("待审")]),t._v(" "),i("navigator-item",{attrs:{icon:"check_circle",index:"PASS"},on:{click:function(){"PASS"!=t.$route.query.status&&t.$router.replace("/audit?status=PASS")}}},[t._v("通过")]),t._v(" "),i("navigator-item",{attrs:{icon:"error",index:"REJECT"},on:{click:function(){"REJECT"!=t.$route.query.status&&t.$router.replace("/audit?status=REJECT")}}},[t._v("驳回")])],1),t._v(" "),i("div",{staticClass:"flex"},[i("div",{staticClass:"flex-col audit-center"},[i("div",{staticClass:"af-topbar flex-v-center f-14 c-6"},[i("i",{staticClass:"icon c-a f-20"},[t._v("search")]),t._v(" "),i("div",{staticClass:"relative",staticStyle:{padding:"0 5px"}},[i("div",{staticClass:"relative flex-v-center a item",on:{click:function(e){t.ui.searchAppShow=!0}}},[i("span",[t._v(t._s(t.searchApp))]),i("i",{staticClass:"icon c-a f-16"},[t._v("keyboard_arrow_down")])]),t._v(" "),t.ui.searchAppShow?i("bubble",{attrs:{pos:"bottom",align:"start"},on:{close:function(e){t.ui.searchAppShow=!1}}},[i("ul",{staticClass:"filter-bubble"},t._l(t.ui.appList,function(e){return i("li",{key:e.id,staticClass:"a",on:{click:function(i){t.filter.app=e.id}}},[t._v(t._s(e.name))])}))]):t._e()],1),t._v(" "),i("div",{staticClass:"relative",staticStyle:{padding:"0 10px"}},[i("div",{staticClass:"relative flex-v-center a item",on:{click:function(e){t.ui.searchOptionShow=!0}}},[i("span",[t._v(t._s(t.searchByName))]),i("i",{staticClass:"icon c-a f-16"},[t._v("keyboard_arrow_down")])]),t._v(" "),t.ui.searchOptionShow?i("bubble",{attrs:{pos:"bottom",align:"start"},on:{close:function(e){t.ui.searchOptionShow=!1}}},[i("ul",{staticClass:"filter-bubble"},t._l(t.ui.searchby,function(e){return i("li",{key:e.id,staticClass:"a",on:{click:function(i){t.filter.searchby=e.id}}},[t._v("\n                "+t._s(e.name)+"\n              ")])}))]):t._e()],1),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.search,expression:"filter.search"}],staticClass:"flex-item c-6 f-14 search-input",attrs:{type:"text",placeholder:"搜索"+t.searchByName+" 回车"},domProps:{value:t.filter.search},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.getList(!0)},input:function(e){e.target.composing||t.$set(t.filter,"search",e.target.value)}}}),t._v(" "),i("icon-btn",{attrs:{small:""},on:{click:function(e){t.filter.search="",t.getList(!0)}}},[t._v("close")])],1),t._v(" "),i("div",{staticClass:"flex-v-center filter-bar c-6 f-13"},[i("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"推荐",expression:"'推荐'"}],staticClass:"icon c-a a item",class:{active:t.filter.recommend},on:{click:function(e){t.filter.recommend=~~!t.filter.recommend||"",t.getList(!0)}}},[t._v("thumb_up")]),t._v(" "),i("span",{staticClass:"flex-item"}),t._v(" "),i("div",{staticClass:"relative"},[i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"筛选分类",expression:"'筛选分类'"}],staticClass:"relative flex-v-center a item",on:{click:function(e){t.ui.classShow=!0}}},[i("span",[t._v("分类")]),i("i",{staticClass:"icon c-a"},[t._v("keyboard_arrow_down")])]),t._v(" "),t.ui.classShow?i("bubble",{attrs:{pos:"bottom",align:"center"},on:{close:function(e){t.ui.classShow=!1}}},[i("ul",{staticClass:"filter-bubble"},t._l(t.classList,function(e){return i("li",{staticClass:"a flex-v-center",staticStyle:{width:"50px"},on:{click:function(i){t.searchClass(e)}}},[i("span",{staticClass:"flex-item"},[t._v(t._s(e.name))]),t._v(" "),e.state?i("i",{staticClass:"icon f-14 blue check-ico"},[t._v("check")]):t._e()])}))]):t._e()],1),t._v(" "),i("div",{staticClass:"relative"},[i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"筛选栏目",expression:"'筛选栏目'"}],staticClass:"relative flex-v-center a item",on:{click:function(e){t.ui.channelShow=!0}}},[i("span",[t._v("栏目")]),i("i",{staticClass:"icon c-a"},[t._v("keyboard_arrow_down")])]),t._v(" "),t.ui.channelShow?i("bubble",{attrs:{pos:"bottom",align:"center"},on:{close:function(e){t.ui.channelShow=!1}}},[i("div",{staticStyle:{padding:"10px 0",width:"280px"}},[i("tree",{attrs:{data:t.ui.channels,"pid-txt":"channelPartentId",nameTxt:"channelName","show-checkbox":"","checked-list":t.channels},on:{"update:checkedList":function(e){t.channels=e}}})],1)]):t._e()],1),t._v(" "),i("div",{staticClass:"relative"},[i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"排序",expression:"'排序'"}],staticClass:"relative flex-v-center a item",on:{click:function(e){t.ui.orderShow=!0}}},[i("span",[t._v("排序")]),i("i",{staticClass:"icon c-a"},[t._v("keyboard_arrow_down")])]),t._v(" "),t.ui.orderShow?i("bubble",{attrs:{pos:"bottom",align:"center"},on:{close:function(e){t.ui.orderShow=!1}}},[i("ul",{staticClass:"filter-bubble"},[t._l(t.ui.orderby,function(e){return i("li",{key:e.id,staticClass:"a flex-v-center",on:{click:function(i){t.filter.orderby=e.id}}},[i("span",{staticClass:"flex-item"},[t._v(t._s(e.name))]),t._v(" "),t.filter.orderby===e.id?i("i",{staticClass:"icon f-14 blue check-ico"},[t._v("check")]):t._e()])}),t._v(" "),i("li",{staticClass:"split-line"}),t._v(" "),i("li",{staticClass:"a flex-v-center",on:{click:function(e){t.filter.order="asc"}}},[i("span",{staticClass:"flex-item"},[t._v("升序")]),"asc"===t.filter.order?i("i",{staticClass:"icon f-14 blue check-ico"},[t._v("check")]):t._e()]),t._v(" "),i("li",{staticClass:"a flex-v-center",on:{click:function(e){t.filter.order="desc"}}},[i("span",{staticClass:"flex-item"},[t._v("降序")]),"desc"===t.filter.order?i("i",{staticClass:"icon f-14 blue check-ico"},[t._v("check")]):t._e()])],2)]):t._e()],1)]),t._v(" "),i("list-view",{ref:"listView",staticClass:"flex-item relative",attrs:{list:t.list,page:t.filter.toPage,totalPage:t.ui.totalPage},on:{prev:t.onPrev,next:t.onNext},scopedSlots:t._u([{key:"default",fn:function(e){return i("li",{},[i("div",{staticClass:"list-item flex-v-center a",class:{on:e.item.id==t.$route.params.id},on:{click:function(i){t.onItemClick(e.item,e.index)}}},[i("div",{staticClass:"list-thumb flex-center relative"},[e.item.thumb.length?i("img",{attrs:{src:e.item.thumb[0].url,alt:""}}):t._e()]),t._v(" "),i("div",{staticClass:"flex-item"},[i("div",{staticClass:"list-title flex-center"},[i("span",[t._v("【"+t._s(e.item.appname)+"】")]),t._v(" "),~~e.item.isRecommnd?i("i",{staticClass:"icon f-16 blue"},[t._v("thumb_up")]):t._e(),t._v(" "),~~e.item.hasThumb?i("i",{staticClass:"icon f-16 orange"},[t._v("image")]):t._e(),t._v(" "),~~e.item.isOriginal?i("i",{staticClass:"icon f-16 green"},[t._v("copyright")]):t._e(),t._v(" "),i("span",{staticClass:"flex-item c-6 f-14 b",attrs:{title:e.item.title}},[t._v(t._s(e.item.title))]),t._v(" "),e.item.auditStatus?i("i",{staticClass:"icon f-16",style:{color:t.ui.status[e.item.auditStatus].color}},[t._v(t._s(t.ui.status[e.item.auditStatus].icon))]):t._e()]),t._v(" "),i("div",{staticClass:"list-info f-12 c-8 flex-v-center"},[i("span",[t._v(t._s(e.item.createDate))]),t._v(" "),i("span",[t._v(t._s(e.item.createUser))])]),t._v(" "),i("div",{staticClass:"list-info f-12 c-8 flex-v-center"},[e.item.pv?i("span",{staticClass:"list-info-num"},[i("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"阅读",expression:"'阅读'"}]},[t._v(t._s(e.item.pv))]),t._v("/"),i("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"评论",expression:"'评论'"}]},[t._v(t._s(e.item.commentCount))]),t._v("/"),i("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"分享",expression:"'分享'"}]},[t._v(t._s(e.item.shareCount))]),t._v("/"),i("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"点赞",expression:"'点赞'"}]},[t._v(t._s(e.item.diggCount))])]):t._e(),t._v(" "),i("span",{staticClass:"flex-item"})])])])])}}])}),t._v(" "),i("div",{staticClass:"af-bottombar flex-center relative"},[i("icon-btn",{staticClass:"a",attrs:{small:"",disabled:t.filter.toPage<=1},on:{click:t.onPrev}},[t._v("keyboard_arrow_left")]),t._v(" "),i("span",{staticClass:"f-14 c-6",staticStyle:{margin:"0 10px","line-height":"1em"}},[t._v("第 "+t._s(t.filter.toPage)+" / "+t._s(t.ui.totalPage)+" 页")]),t._v(" "),i("icon-btn",{staticClass:"a",attrs:{small:"",disabled:t.filter.toPage>=t.ui.totalPage},on:{click:t.onNext}},[t._v("keyboard_arrow_right")]),t._v(" "),t.totalRowsAmount?i("span",{staticStyle:{position:"absolute",right:"10px",bottom:"8px","font-size":"12px",color:"#999"}},[t._v("共 "+t._s(t.totalRowsAmount)+" 项")]):t._e()],1)],1)]),t._v(" "),i("div",{staticClass:"af-right flex-item flex-col"},[i("div",{staticClass:"af-topbar flex-v-center"},[t.id?i("div",{staticClass:"flex-v-center"},["AUDITING"===t.$route.query.status||t.status?i("icon-btn",{directives:[{name:"tooltip",rawName:"v-tooltip:bottom",value:"审核通过",expression:"'审核通过'",arg:"bottom"}],staticStyle:{"margin-right":"10px"},attrs:{color:"#4caf50"},on:{click:function(e){t.audit("PASS")}}},[t._v("check_circle_outline")]):t._e(),t._v(" "),"AUDITING"===t.$route.query.status||t.status?i("icon-btn",{directives:[{name:"tooltip",rawName:"v-tooltip:bottom",value:"审核驳回",expression:"'审核驳回'",arg:"bottom"}],attrs:{color:"#ff5252"},on:{click:function(e){t.rejectMessage="",t.ui.rejectShow=!0}}},[t._v("error_outline")]):t._e()],1):t._e(),t._v(" "),i("div",{staticClass:"flex-item"}),t._v(" "),i("account")],1),t._v(" "),i("router-view",{ref:"content",attrs:{channels:t.ui.channels}})],1),t._v(" "),t.ui.rejectShow?i("layer",{attrs:{title:"审核驳回",width:"600px"}},[i("div",{staticClass:"layer-text"},[i("input-box",{attrs:{"multi-line":"",rows:"10",label:"请输入驳回理由"},model:{value:t.rejectMessage,callback:function(e){t.rejectMessage=e},expression:"rejectMessage"}})],1),t._v(" "),i("div",{staticClass:"layer-btns"},[i("btn",{attrs:{flat:""},on:{click:function(e){t.ui.rejectShow=!1}}},[t._v("取消")]),t._v(" "),i("btn",{attrs:{flat:"",color:"#008eff"},on:{click:function(e){t.audit("REJECT")}}},[t._v("确定")])],1)]):t._e()],1)};r._withStripped=!0;var c={render:r,staticRenderFns:[]},u=c;var p=!1;var d=i("VU/8")(l,u,!1,function(t){p||i("XFP5")},null,null);d.options.__file="src/apps/audit/index.vue";e.default=d.exports},XFP5:function(t,e,i){var a=i("lEkF");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("100c7979",a,!1,{})},lEkF:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.app-audit .list-item {\n  width: auto;\n}\n.app-audit .list-item .list-title {\n  max-width: 269px;\n}\n.app-audit .navigator-item .icon {\n  -webkit-transition: none;\n  transition: none;\n}\n.app-audit .navigator-item.active {\n  background: #4DB6AC;\n  color: #fff;\n}\n.app-audit .af-topbar {\n  line-height: 1em;\n}\n.app-audit .search-input {\n  height: 30px;\n  border: none;\n  background: transparent;\n  margin-left: 10px;\n  line-height: 1em;\n}\n.app-audit .search-input::-webkit-input-placeholder {\n  color: #aaa;\n}\n.app-audit .filter-bar {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  padding: 0 15px;\n  height: 36px;\n  line-height: 1em;\n}\n.app-audit .filter-bar .item {\n  padding: 5px;\n  line-height: 16px;\n}\n.app-audit .filter-bar .icon {\n  font-size: 16px;\n}\n.app-audit .filter-bar .item:hover {\n  color: #666;\n}\n.app-audit .filter-bar .item.active {\n  color: #018be6;\n}\n.app-audit .filter-bubble {\n  padding: 10px 0;\n  white-space: nowrap;\n}\n.app-audit .filter-bubble li {\n  padding: 5px 10px;\n}\n.app-audit .filter-bubble li:hover {\n  background: #eee;\n}\n.app-audit .filter-bubble li.split-line {\n  height: 1px;\n  background: #eee;\n  padding: 0;\n  margin: 5px;\n}\n.app-audit .filter-bubble .check-ico {\n  margin-left: 10px;\n}\n.app-audit .audit-center {\n  width: 400px;\n  border-right: 1px solid rgba(0, 0, 0, 0.1);\n  background: #f8f8f8;\n}\n.app-audit .list-item.on {\n  background: #42aad8;\n  color: #fff;\n}\n.app-audit .list-item.on .list-title span {\n  color: #fff;\n}\n.app-audit .list-item.on .list-info {\n  color: rgba(255, 255, 255, 0.8);\n}\n.app-audit .list-item.on .tg-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n.app-audit .list-thumb {\n  width: 80px;\n  min-width: 80px;\n  height: 60px;\n  background: rgba(0, 0, 0, 0.07);\n  margin-right: 10px;\n}\n.app-audit .list-thumb img {\n  max-width: 100%;\n  max-height: 100%;\n}\n.app-audit .active {\n  color: #018be6;\n}\n",""])}});